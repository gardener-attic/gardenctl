groups:
- name: cadvisor.rules
  rules:
  - alert: cAdvisorCantBeScrapped
    # TODO: make this rule check individual nodes
    expr: absent(container_cpu_cfs_periods_total{type="seed"}) or absent(container_cpu_cfs_periods_total{type="shoot"})
    for: 7m
    labels:
      service: kubelet
      severity: warning
    annotations:
      description: |
        cAdvisor for {{ $labels.type }} cluster can't be scrapped.
        After Kubernetes 1.7.3 cAdvisor's metrics are exposed at 'kubelet-host/metrics/cadvisor'
      summary: Kubelet's cAvisor can't be scrapped
  - alert: ContainerExcessiveFSUsage
    expr: container_fs_usage_bytes{container_name!="POD"} > 1e+9
    for: 10m
    labels:
      service: kubelet
      severity: warning
    annotations:
      description: |
        The container {{ $labels.container_name }} in {{ $labels.type }} cluster pod {{ $labels.pod_name }} has excessively high usage of file system resources: {{ $value / 1e+6 }}MB. This includes image size plus any other resources generated by the container.
      summary: Container performs excessive usage of file system resources.